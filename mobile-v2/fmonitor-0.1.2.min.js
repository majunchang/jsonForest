!function(){"use strict";var Ft="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var i=t(function(t,e){var i="__lodash_hash_undefined__",r=9007199254740991,n="[object Arguments]",o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",c="[object Null]",T="[object Object]",u="[object Proxy]",d="[object Undefined]",p=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[n]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l[a]=l["[object Map]"]=l["[object Number]"]=l[T]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var f="object"==typeof Ft&&Ft&&Ft.Object===Object&&Ft,v="object"==typeof self&&self&&self.Object===Object&&self,g=f||v||Function("return this")(),y=e&&!e.nodeType&&e,w=y&&t&&!t.nodeType&&t,m=w&&w.exports===y,b=m&&f.process,_=function(){try{return b&&b.binding&&b.binding("util")}catch(t){}}(),S=_&&_.isTypedArray;function j(t,e){return"__proto__"==e?void 0:t[e]}var C,k,E,x=Array.prototype,L=Function.prototype,O=Object.prototype,U=g["__core-js_shared__"],P=L.toString,A=O.hasOwnProperty,I=(C=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"",R=O.toString,$=P.call(Object),M=RegExp("^"+P.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=m?g.Buffer:void 0,F=g.Symbol,N=g.Uint8Array,Q=D?D.allocUnsafe:void 0,z=(k=Object.getPrototypeOf,E=Object,function(t){return k(E(t))}),V=Object.create,B=O.propertyIsEnumerable,q=x.splice,H=F?F.toStringTag:void 0,W=function(){try{var t=yt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),G=D?D.isBuffer:void 0,J=Math.max,X=Date.now,Z=yt(g,"Map"),K=yt(Object,"create"),Y=function(){function n(){}return function(t){if(!Ut(t))return{};if(V)return V(t);n.prototype=t;var e=new n;return n.prototype=void 0,e}}();function tt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function et(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function nt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function it(t){var e=this.__data__=new et(t);this.size=e.size}function rt(t,e){var n=kt(t),i=!n&&Ct(t),r=!n&&!i&&xt(t),o=!n&&!i&&!r&&It(t),a=n||i||r||o,s=a?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],c=s.length;for(var u in t)!e&&!A.call(t,u)||a&&("length"==u||r&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||wt(u,c))||s.push(u);return s}function ot(t,e,n){(void 0===n||jt(t[e],n))&&(void 0!==n||e in t)||st(t,e,n)}function at(t,e){for(var n=t.length;n--;)if(jt(t[n][0],e))return n;return-1}function st(t,e,n){"__proto__"==e&&W?W(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}tt.prototype.clear=function(){this.__data__=K?K(null):{},this.size=0},tt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},tt.prototype.get=function(t){var e=this.__data__;if(K){var n=e[t];return n===i?void 0:n}return A.call(e,t)?e[t]:void 0},tt.prototype.has=function(t){var e=this.__data__;return K?void 0!==e[t]:A.call(e,t)},tt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=K&&void 0===e?i:e,this},et.prototype.clear=function(){this.__data__=[],this.size=0},et.prototype.delete=function(t){var e=this.__data__,n=at(e,t);return!(n<0||(n==e.length-1?e.pop():q.call(e,n,1),--this.size,0))},et.prototype.get=function(t){var e=this.__data__,n=at(e,t);return n<0?void 0:e[n][1]},et.prototype.has=function(t){return-1<at(this.__data__,t)},et.prototype.set=function(t,e){var n=this.__data__,i=at(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},nt.prototype.clear=function(){this.size=0,this.__data__={hash:new tt,map:new(Z||et),string:new tt}},nt.prototype.delete=function(t){var e=gt(this,t).delete(t);return this.size-=e?1:0,e},nt.prototype.get=function(t){return gt(this,t).get(t)},nt.prototype.has=function(t){return gt(this,t).has(t)},nt.prototype.set=function(t,e){var n=gt(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},it.prototype.clear=function(){this.__data__=new et,this.size=0},it.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},it.prototype.get=function(t){return this.__data__.get(t)},it.prototype.has=function(t){return this.__data__.has(t)},it.prototype.set=function(t,e){var n=this.__data__;if(n instanceof et){var i=n.__data__;if(!Z||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new nt(i)}return n.set(t,e),this.size=n.size,this};var ct,ut=function(t,e,n){for(var i=-1,r=Object(t),o=n(t),a=o.length;a--;){var s=o[ct?a:++i];if(!1===e(r[s],s,r))break}return t};function dt(t){return null==t?void 0===t?d:c:H&&H in Object(t)?function(t){var e=A.call(t,H),n=t[H];try{t[H]=void 0}catch(t){}var i=R.call(t);e?t[H]=n:delete t[H];return i}(t):(e=t,R.call(e));var e}function pt(t){return Pt(t)&&dt(t)==n}function ht(t){return!(!Ut(t)||(e=t,I&&I in e))&&(Lt(t)?M:p).test(function(t){if(null!=t){try{return P.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function lt(t){if(!Ut(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=mt(t),n=[];for(var i in t)("constructor"!=i||!e&&A.call(t,i))&&n.push(i);return n}function ft(i,r,o,a,s){i!==r&&ut(r,function(t,e){if(Ut(t))s||(s=new it),function(t,e,n,i,r,o,a){var s=j(t,n),c=j(e,n),u=a.get(c);if(u)return ot(t,n,u);var d=o?o(s,c,n+"",t,e,a):void 0,p=void 0===d;if(p){var h=kt(c),l=!h&&xt(c),f=!h&&!l&&It(c);d=c,h||l||f?kt(s)?d=s:Pt(_=s)&&Et(_)?d=function(t,e){var n=-1,i=t.length;e||(e=Array(i));for(;++n<i;)e[n]=t[n];return e}(s):l?d=function(t,e){if(e)return t.slice();var n=t.length,i=Q?Q(n):new t.constructor(n);return t.copy(i),i}(c,!(p=!1)):f?(y=c,w=!(p=!1)?(m=y.buffer,b=new m.constructor(m.byteLength),new N(b).set(new N(m)),b):y.buffer,d=new y.constructor(w,y.byteOffset,y.length)):d=[]:function(t){if(!Pt(t)||dt(t)!=T)return!1;var e=z(t);if(null===e)return!0;var n=A.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&P.call(n)==$}(c)||Ct(c)?Ct(d=s)?d=function(t,e,n,i){var r=!n;n||(n={});for(var o,a,s,c,u=-1,d=e.length;++u<d;){var p=e[u],h=i?i(n[p],t[p],p,n,t):void 0;void 0===h&&(h=t[p]),r?st(n,p,h):(s=h,c=(o=n)[a=p],A.call(o,a)&&jt(c,s)&&(void 0!==s||a in o)||st(o,a,s))}return n}(g=s,Rt(g)):(!Ut(s)||i&&Lt(s))&&(d="function"!=typeof(v=c).constructor||mt(v)?{}:Y(z(v))):p=!1}var v;var g;var y,w,m,b;var _;p&&(a.set(c,d),r(d,c,i,o,a),a.delete(c));ot(t,n,d)}(i,r,e,o,ft,a,s);else{var n=a?a(j(i,e),t,e+"",i,r,s):void 0;void 0===n&&(n=t),ot(i,e,n)}},Rt)}function vt(t,e){return St((o=t,s=Dt,a=J(void 0===(a=e)?o.length-1:a,0),function(){for(var t=arguments,e=-1,n=J(t.length-a,0),i=Array(n);++e<n;)i[e]=t[a+e];e=-1;for(var r=Array(a+1);++e<a;)r[e]=t[e];return r[a]=s(i),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(o,this,r)}),t+"");var o,a,s}function gt(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function yt(t,e){var n,i,r=(i=e,null==(n=t)?void 0:n[i]);return ht(r)?r:void 0}function wt(t,e){var n=typeof t;return!!(e=null==e?r:e)&&("number"==n||"symbol"!=n&&h.test(t))&&-1<t&&t%1==0&&t<e}function mt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||O)}var bt,_t,Tt,St=(bt=W?function(t,e){return W(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:Dt,Tt=_t=0,function(){var t=X(),e=16-(t-Tt);if(Tt=t,0<e){if(800<=++_t)return arguments[0]}else _t=0;return bt.apply(void 0,arguments)});function jt(t,e){return t===e||t!=t&&e!=e}var Ct=pt(function(){return arguments}())?pt:function(t){return Pt(t)&&A.call(t,"callee")&&!B.call(t,"callee")},kt=Array.isArray;function Et(t){return null!=t&&Ot(t.length)&&!Lt(t)}var xt=G||function(){return!1};function Lt(t){if(!Ut(t))return!1;var e=dt(t);return e==a||e==s||e==o||e==u}function Ot(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=r}function Ut(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Pt(t){return null!=t&&"object"==typeof t}var At,It=S?(At=S,function(t){return At(t)}):function(t){return Pt(t)&&Ot(t.length)&&!!l[dt(t)]};function Rt(t){return Et(t)?rt(t,!0):lt(t)}var $t,Mt=($t=function(t,e,n){ft(t,e,n)},vt(function(t,e){var n=-1,i=e.length,r=1<i?e[i-1]:void 0,o=2<i?e[2]:void 0;for(r=3<$t.length&&"function"==typeof r?(i--,r):void 0,o&&function(t,e,n){if(!Ut(n))return!1;var i=typeof e;return!!("number"==i?Et(n)&&wt(e,n.length):"string"==i&&e in n)&&jt(n[e],t)}(e[0],e[1],o)&&(r=i<3?void 0:r,i=1),t=Object(t);++n<i;){var a=e[n];a&&$t(t,a,n,r)}return t}));function Dt(t){return t}t.exports=Mt}),e="Expected a function",r="__lodash_hash_undefined__",n=1/0,o="[object Function]",a="[object GeneratorFunction]",s="[object Symbol]",c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/,d=/^\./,p=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,h=/\\(\\)?/g,l=/^\[object .+?Constructor\]$/,f="object"==typeof Ft&&Ft&&Ft.Object===Object&&Ft,v="object"==typeof self&&self&&self.Object===Object&&self,g=f||v||Function("return this")();var y,w=Array.prototype,m=Function.prototype,b=Object.prototype,_=g["__core-js_shared__"],T=(y=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||""))?"Symbol(src)_1."+y:"",S=m.toString,j=b.hasOwnProperty,C=b.toString,k=RegExp("^"+S.call(j).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),E=g.Symbol,x=w.splice,L=N(g,"Map"),O=N(Object,"create"),U=E?E.prototype:void 0,P=U?U.toString:void 0;function A(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function I(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function R(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function $(t,e){for(var n,i,r=t.length;r--;)if((n=t[r][0])===(i=e)||n!=n&&i!=i)return r;return-1}function M(t,e){for(var n,i=0,r=(e=function(t,e){if(B(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||H(t))return!0;return u.test(t)||!c.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:B(n=e)?n:Q(n)).length;null!=t&&i<r;)t=t[z(e[i++])];return i&&i==r?t:void 0}function D(t){return!(!q(t)||(e=t,T&&T in e))&&((i=q(n=t)?C.call(n):"")==o||i==a||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?k:l).test(function(t){if(null!=t){try{return S.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e,n,i}function F(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function N(t,e){var n,i,r=(i=e,null==(n=t)?void 0:n[i]);return D(r)?r:void 0}A.prototype.clear=function(){this.__data__=O?O(null):{}},A.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},A.prototype.get=function(t){var e=this.__data__;if(O){var n=e[t];return n===r?void 0:n}return j.call(e,t)?e[t]:void 0},A.prototype.has=function(t){var e=this.__data__;return O?void 0!==e[t]:j.call(e,t)},A.prototype.set=function(t,e){return this.__data__[t]=O&&void 0===e?r:e,this},I.prototype.clear=function(){this.__data__=[]},I.prototype.delete=function(t){var e=this.__data__,n=$(e,t);return!(n<0||(n==e.length-1?e.pop():x.call(e,n,1),0))},I.prototype.get=function(t){var e=this.__data__,n=$(e,t);return n<0?void 0:e[n][1]},I.prototype.has=function(t){return-1<$(this.__data__,t)},I.prototype.set=function(t,e){var n=this.__data__,i=$(n,t);return i<0?n.push([t,e]):n[i][1]=e,this},R.prototype.clear=function(){this.__data__={hash:new A,map:new(L||I),string:new A}},R.prototype.delete=function(t){return F(this,t).delete(t)},R.prototype.get=function(t){return F(this,t).get(t)},R.prototype.has=function(t){return F(this,t).has(t)},R.prototype.set=function(t,e){return F(this,t).set(t,e),this};var Q=V(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(H(t))return P?P.call(t):"";var e=t+"";return"0"==e&&1/t==-n?"-0":e}(e);var r=[];return d.test(t)&&r.push(""),t.replace(p,function(t,e,n,i){r.push(n?i.replace(h,"$1"):e||t)}),r});function z(t){if("string"==typeof t||H(t))return t;var e=t+"";return"0"==e&&1/t==-n?"-0":e}function V(r,o){if("function"!=typeof r||o&&"function"!=typeof o)throw new TypeError(e);var a=function(){var t=arguments,e=o?o.apply(this,t):t[0],n=a.cache;if(n.has(e))return n.get(e);var i=r.apply(this,t);return a.cache=n.set(e,i),i};return a.cache=new(V.Cache||R),a}V.Cache=R;var B=Array.isArray;function q(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function H(t){return"symbol"==typeof t||!!(e=t)&&"object"==typeof e&&C.call(t)==s;var e}var W=function(t,e,n){var i=null==t?void 0:M(t,e);return void 0===i?n:i},G=t(function(t,e){var n;n=function(){function v(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}return function t(l){function f(t,e,n){var i;if("undefined"!=typeof document){if(1<arguments.length){if("number"==typeof(n=v({path:"/"},f.defaults,n)).expires){var r=new Date;r.setMilliseconds(r.getMilliseconds()+864e5*n.expires),n.expires=r}n.expires=n.expires?n.expires.toUTCString():"";try{i=JSON.stringify(e),/^[\{\[]/.test(i)&&(e=i)}catch(t){}e=l.write?l.write(e,t):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var o="";for(var a in n)n[a]&&(o+="; "+a,!0!==n[a]&&(o+="="+n[a]));return document.cookie=t+"="+e+o}t||(i={});for(var s=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,u=0;u<s.length;u++){var d=s[u].split("="),p=d.slice(1).join("=");this.json||'"'!==p.charAt(0)||(p=p.slice(1,-1));try{var h=d[0].replace(c,decodeURIComponent);if(p=l.read?l.read(p,h):l(p,h)||p.replace(c,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(t){}if(t===h){i=p;break}t||(i[h]=p)}catch(t){}}return i}}return(f.set=f).get=function(t){return f.call(f,t)},f.getJSON=function(){return f.apply({json:!0},[].slice.call(arguments))},f.defaults={},f.remove=function(t,e){f(t,"",v(e,{expires:-1}))},f.withConverter=t,f}(function(){})},t.exports=n()}),J={prefix:"_mfm_",session:{expires:18e5}};function X(){try{var t=new Uint32Array(1);return window.crypto.getRandomValues(t),String(2147483647&t[0])}catch(t){return String(Math.round(2147483647*Math.random()))}}var Z=function(){function l(t,e){void 0===e&&(e={}),this.appConfig=t,this.$set(t,e)}var t=l.prototype;return t.$set=function(t,e){void 0===e&&(e={});for(var n,i,r,o={imei:X(),uid:X(),did:X(),isLog:Number(Math.ceil(100*Math.random())<=this.appConfig.sampleRate),isSpeedLog:Number(Math.ceil(100*Math.random())<=this.appConfig.siteSpeedSampleRate)},a={appVersion:window.navigator.appVersion,appName:window.navigator.appName,appid:this.appConfig.appid,appname:this.appConfig.appname},s=Object.keys(o),c=Object.keys(a),u=0;u<s.length;u++){var d=s[u];this[d]=(i=e[n=d]||o[d],r=t.expires,void 0,G.get(""+J.prefix+n)||(G.set(""+J.prefix+n,i,{expires:new Date(Date.now()+r),path:"/"}),i))}for(var p=0;p<c.length;p++){var h=c[p];this[h]=e[h]||a[h]}l.$setSessionId()},t.get=function(t){void 0===t&&(t={});var e={imei:this.imei,uid:this.uid,did:this.did,appVersion:this.appVersion,appName:this.appName,appid:this.appid,appname:this.appname,network:window.navigator.connection&&window.navigator.connection.effectiveType,userAgent:window.navigator.userAgent};e.sessionId=l.$getSessionId();var n=i({},e,t);return n.url&&(n.url=this.appConfig.parseUrl(n.url)),n.title&&(n.title=this.appConfig.parseTitle(n.url)),n},t.getIsLog=function(){return Boolean(Number(this.isLog))},t.getIsSpeedLog=function(){return Boolean(Number(this.isSpeedLog))},l.$setSessionId=function(){var t=X();return G.set(J.prefix+"sessionId",t,{expires:new Date(Date.now()+J.session.expires)}),t},l.$getSessionId=function(){var t=G.get(J.prefix+"sessionId");return t||l.$setSessionId()},t.update=function(t){var e,n,i=Object.key(t),r=Array.isArray(i),o=0;for(i=r?i:i[Symbol.iterator]();;){var a;if(r){if(o>=i.length)break;a=i[o++]}else{if((o=i.next()).done)break;a=o.value}var s=a;this[s]&&(this[s]=!!(n=t[e=s])&&(G.set(""+J.prefix+e,n),n))}},t.getBody=function(t){return void 0===t&&(t={}),Object.assign({},this.get(t))},l}();function K(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}function Y(){}function tt(t,e,n,i){void 0===i&&(i=Y);var r,o,a=t,s=X()+"_IMGPING_MFM",c=function(){window[s]=null,i(!0,e,n)};return window[s]=(r=a,(o=window.document.createElement("img")).width=1,o.height=1,o.src=r,o),window[s].onload=c,window[s].onerror=c,!0}function et(t,e,n){return void 0===n&&(n=Y),window.navigator.sendBeacon?function(t,e,n){void 0===n&&(n=Y);var i=new window.Blob([K(t)],{type:"application/x-www-form-urlencoded;charset=UTF-8"}),r=window.navigator.sendBeacon(e,i);return n(r,t,e),r}(t,e,n):function(t,e,n){void 0===n&&(n=Y);var i=new window.XMLHttpRequest;return i?(i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),i.onreadystatechange=function(){4===i.readyState?(n(!0,t,e),i=null):n(!1,t,e)},i.send(K(t)),!0):n(!1,t,e)}(t,e,n)}function nt(t,e,n,i){return void 0===n&&(n=Y),void 0===i&&(i=0),function(t,e,n){void 0===n&&(n=Y);var i=K(t),r=e+"?"+i;return i.length<=2036?tt(r,t,e,n):et(t,e,n)}(t,e,n)}function it(){return window.location.pathname+window.location.search+window.location.hash}function rt(){return{hidden:1,VISIBLE:0}[window.document.visibilityState]||0}var ot=function(){function t(t){if(function(n){if(!("onhashchange"in n)){var i=n.location.location,r=i.href,o=i.hash;n.setInterval(function(){var t=i.href,e=i.hash;e!==o&&"function"==typeof n.onhashchange&&(n.onhashchange({type:"hashchange",oldURL:r,newURL:t}),r=t,o=e)},100)}}(window),!window.addEventListener)throw new Error("use addEventListener in unsupporting browsers");var e={shouldTrackHashChange:this.shouldTrackHashChange};this.opts=Object.assign(e,t),this.trackerQeueu=[],this.path=it(),window.addEventListener("hashchange",this.handleHashChange,!1)}var e=t.prototype;return e.addTracker=function(t,e){void 0===e&&(e=null),this.trackerQeueu.push({tracker:t,context:e})},e.tracker=function(e){this.trackerQeueu.forEach(function(t){t.tracker.call(t.context,e)})},e.handleHashChange=function(){var i=this,r=Date.now();setTimeout(function(){var t=i.path,e=it();if(t!==e&&i.opts.shouldTrackUrlChange.call(i,e,t)){i.path=e;var n={body:{timestamp:r,type:"pv",url:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname,title:window.document.title,referer:window.document.referrer,visibility:rt()}};i.tracker(n)}},0)},e.shouldTrackHashChange=function(t,e){return!(!t||!e)},t}(),at=[];function st(e,n){var t=at.filter(function(t){return t.context==e&&t.methodName==n})[0];return t||(t=new ct(e,n),at.push(t)),t}var ct=function(){function t(t,e){var n=this;this.context=t,this.methodName=e,this.originalMethodReference=t[e],this.methodChain=[],this.boundMethodChain=[],this.wrappedMethod=function(){return n.boundMethodChain[n.boundMethodChain.length-1].apply(void 0,arguments)},t[e]=this.wrappedMethod}t.add=function(t,e,n){st(t,e).add(n)},t.remove=function(t,e,n){st(t,e).remove(n)};var e=t.prototype;return e.add=function(t){this.methodChain.push(t),this.rebindMethodChain()},e.remove=function(t){var e=this.methodChain.indexOf(t);-1<e&&(this.methodChain.splice(e,1),0<this.methodChain.length?this.rebindMethodChain():this.destroy())},e.rebindMethodChain=function(){this.boundMethodChain=[];for(var t,e=0;t=this.methodChain[e];e++){var n=this.boundMethodChain[e-1]||this.originalMethodReference.bind(this.context);this.boundMethodChain.push(t(n))}},e.destroy=function(){var t=at.indexOf(this);-1<t&&(at.splice(t,1),this.context[this.methodName]=this.originalMethodReference)},t}(),ut=function(){function n(t){if(window.history.pushState&&window.addEventListener){var e={shouldTrackUrlChange:n.shouldTrackUrlChange,trackReplaceState:!0};this.opts=Object.assign(e,t),this.path=it(),this.trackerQeueu=[],this.pushStateOverride=this.pushStateOverride.bind(this),this.replaceStateOverride=this.replaceStateOverride.bind(this),this.handlePopState=this.handlePopState.bind(this),ct.add(window.history,"pushState",this.pushStateOverride),ct.add(window.history,"replaceState",this.replaceStateOverride),window.addEventListener("popstate",this.handlePopState)}}var t=n.prototype;return t.addTracker=function(t,e){void 0===e&&(e=null),this.trackerQeueu.push({tracker:t,context:e})},t.tracker=function(e){this.trackerQeueu.forEach(function(t){t.tracker.call(t.context,e)})},t.pushStateOverride=function(t){var e=this;return function(){t.apply(void 0,arguments),e.handleUrlChange(!0)}},t.replaceStateOverride=function(t){var e=this;return function(){t.apply(void 0,arguments),e.handleUrlChange(!1)}},t.handlePopState=function(){this.handleUrlChange(!0)},t.handleUrlChange=function(i){var r=this,o=Date.now();setTimeout(function(){var t=r.path,e=it();if(t!==e&&r.opts.shouldTrackUrlChange.call(r,e,t)){r.path=e;var n={body:{timestamp:o,type:"pv",url:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname,title:window.document.title,referer:window.document.referrer,visibility:rt()}};(i||r.opts.trackReplaceState)&&r.tracker(n)}},0)},n.shouldTrackUrlChange=function(t,e){return!(!t||!e)},n}(),dt="hidden",pt="visible";function ht(t){void 0===t&&(t={});var e={body:{timestamp:Date.now(),url:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname,title:window.document.title,referer:window.document.referrer,visibility:rt()}};return e.body=Object.assign({},e.body,t),e}var lt=function(){function t(t,e){void 0===e&&(e={}),window.document.visibilityState||console.error("use visibilityState in unsupporting browsers");var n={sessionTimeout:J.session.expires,visibleThreshold:5e3,sendInitialPageview:!0};this.appConfig=t,this.opts=Object.assign(n,e),this.lastPageState=window.document.visibilityState,this.$isInitialPageviewSent=!1,this.$visibleThresholdTimeout=null,this.pageLoadTrackerQeueu=[],this.pageviewTrackerQeueu=[],this.pageVisibilityEventTrackerQeueu=[],this.pageUnloadTrackerQeueu=[],this.handleWindowLoad=this.handleWindowLoad.bind(this),this.handleWindowUnload=this.handleWindowUnload.bind(this),this.handleChange=this.handleChange.bind(this),window.addEventListener("load",this.handleWindowLoad),window.addEventListener("unload",this.handleWindowUnload),window.document.addEventListener("visibilitychange",this.handleChange)}var e=t.prototype;return e.handleChange=function(){var t=this;window.document.visibilityState!==pt&&window.document.visibilityState!==dt||(window.document.visibilityState===pt&&this.opts.sendInitialPageview&&!this.$isInitialPageviewSent&&(this.sendPageview(ht({type:"pv"})),this.$isInitialPageviewSent=!0),window.document.visibilityState===dt&&this.$visibleThresholdTimeout&&clearTimeout(this.$visibleThresholdTimeout),G.get(this.appConfig.prefix+"sessionId")?this.lastPageState===dt&&window.document.visibilityState===pt&&(clearTimeout(this.$visibleThresholdTimeout),this.$visibleThresholdTimeout=setTimeout(function(){t.sendPageview(ht({type:"pv"}))},this.opts.visibleThreshold)):G.set(this.appConfig.prefix+"sessionId",X(),{expires:new Date(Date.now()+this.sessionTimeout),path:"/"}),this.lastPageState=window.document.visibilityState)},e.addPageloadTracker=function(t,e){void 0===e&&(e=null),this.pageLoadTrackerQeueu.push({tracker:t,context:e})},e.sendPageLoad=function(e){this.pageLoadTrackerQeueu.forEach(function(t){t.tracker.call(t.context,e)})},e.addPageviewTracker=function(t,e){void 0===e&&(e=null),this.pageviewTrackerQeueu.push({tracker:t,context:e})},e.sendPageview=function(e){this.pageviewTrackerQeueu.forEach(function(t){t.tracker.call(t.context,e)})},e.addPageVisibilityEventTracker=function(t,e){void 0===e&&(e=null),this.pageVisibilityEventTrackerQeueu.push({tracker:t,context:e})},e.sendPageVisibilityEvent=function(e){this.pageVisibilityEventTrackerQeueu.forEach(function(t){t.tracker.call(t.context,e)})},e.addPageUnloadTracker=function(t,e){void 0===e&&(e=null),this.pageUnloadTrackerQeueu.push({tracker:t,context:e})},e.sendPageUnload=function(e){this.pageUnloadTrackerQeueu.forEach(function(t){t.tracker.call(t.context,e)})},e.handleWindowLoad=function(){this.lastPageState===pt&&(this.handleChange(),this.sendPageLoad(ht({type:"pl"})))},e.handleWindowUnload=function(){this.lastPageState!==dt&&(this.handleChange(),this.sendPageUnload(ht({type:"pul"})))},t}();function ft(t,e){var n=window.document.createElement("a");return n.href=t,n[e]||t}function vt(n){!function(n){function t(t){var e=new n.CustomEvent(t,{detail:this});n.dispatchEvent(e)}!function(r){try{new r.CustomEvent("T")}catch(t){var e=function(t,e){void 0===e&&(e={});var n=Object.assign({bubbles:!1,cancelable:!1,detail:void 0},e),i=r.document.createEvent("CustomEvent");return i.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),i};e.prototype=r.Event.prototype,r.CustomEvent=e}}(n);var e=n.XMLHttpRequest;n.XMLHttpRequest=function(){var o=new e,a=o.open;return o.open=function(t,e,n,i,r){return void 0===n&&(n=!0),void 0===i&&(i=null),void 0===r&&(r=null),o.requestURL=e,a.apply(this,arguments)},o.addEventListener("loadstart",function(){t.call(this,"ajaxLoadStart")},!1),o.addEventListener("progress",function(){t.call(this,"ajaxProgress")},!1),o.addEventListener("abort",function(){t.call(this,"ajaxAbort")},!1),o.addEventListener("error",function(){t.call(this,"ajaxError")},!1),o.addEventListener("load",function(){t.call(this,"ajaxLoad")},!1),o.addEventListener("timeout",function(){t.call(this,"ajaxTimeout")},!1),o.addEventListener("loadend",function(){t.call(this,"ajaxLoadEnd")},!1),o.addEventListener("readystatechange",function(){t.call(this,"ajaxReadyStateChange")},!1),o}}(window);var e={},i=function(t,e){var n;void 0===e&&(e={});try{n=JSON.stringify(t.response)}catch(t){n={}}var i=t.requestURL,r={body:{type:"api",timestamp:Date.now(),url:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname,title:window.document.title,referer:window.document.referrer,visibility:rt(),apiUrl:ft(i,"pathname"),apiStatus:t.status,apiCode:n.errCode}};return Object.assign({},r,e)},r=function(t){var e=ft(t.requestURL,"pathname");return n.appConfig.ignoreUrl(e)};return window.addEventListener("ajaxLoadStart",function(t){t.detail.id=X(),e[t.detail.id]=window.performance.now()}),window.addEventListener("ajaxError",function(t){r(t.detail)||(n.send(i(t.detail,{apiTime:window.performance.now()-e[t.detail.id]})),delete e[t.detail.id])}),window.addEventListener("ajaxTimeout",function(t){r(t.detail)||(n.send(i(t.detail,{apiTime:window.performance.now()-e[t.detail.id]})),delete e[t.detail.id])}),window.addEventListener("ajaxLoadEnd",function(t){r(t.detail)||(n.send(i(t.detail,{apiTime:window.performance.now()-e[t.detail.id]})),delete e[t.detail.id])}),!0}function gt(a){return window.addEventListener("load",function(t){var e={};window.performance.timing&&(e=window.performance.timing);var n,i,r,o={type:"p",timestamp:Date.now(),url:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname,title:window.document.title,referer:window.document.referrer,visibility:rt(),pDns:e.domainLookupEnd-e.domainLookupStart,pTcp:e.connectEnd-e.connectStart,pSsl:e.connectEnd-e.secureConnectionStart,pTtfb:e.responseStart-e.requestStart,pTrans:e.responseEnd-e.responseStart,pDom:e.domInteractive-e.responseEnd,pRes:e.loadEventStart-e.domContentLoadedEventEnd,pFirstbyte:e.responseStart-e.domainLookupStart,pFpt:e.responseEnd-e.fetchStart,pTti:e.domInteractive-e.fetchStart,pReady:e.domContentLoadedEventEnd-e.fetchStart,pLoad:e.loadEventStart-e.fetchStart,pEntry:(n=["paint","resource"],i=a,r=[],n.forEach(function(t){window.performance&&window.performance.getEntries&&window.performance.getEntries({entryType:t}).forEach(function(t){var e={type:t.initiatorType,name:t.name,duration:t.duration,time:t.startTime+t.duration};if("resource"===t.entryType&&"xmlhttprequest"!==t.initiatorType&&"beacon"!==t.initiatorType){var n="img"===t.initiatorType?i.appConfig.resource.imgTimeout:i.appConfig.resource.timeout;t.duration>n&&r.push(e)}else"paint"===r.entryType&&r.push({type:"paint",name:t.name,duration:t.duration,time:t.startTime+t.duration})})}),r)};a.send({body:o})}),!0}function yt(e){void 0===e&&(e={});var t=Object.keys(e),n=["uid","imei","userAgent","hostname","pathname","appName","appVersion","appid","appname","type","apiUrl","apiTime","appStatus","apiCode","pDns","pTcp","pSsl","pTtfb","pTrans","pDom","pRes","pFirstbyte","pFpt","pTti","pReady","pLoad"],i={uid:e.uid,imei:e.imei,ua:e.userAgent,hostname:e.hostname,pathname:e.pathname,app_name:e.appName,app_version:window.location.href,pid:e.appid,pname:e.appname,type:e.type,ext:{}};return"api"===e.type&&(i.api_url=e.apiUrl,i.api_time=e.apiTime,i.api_status=e.appStatus,i.api_code=e.apiCode),"p"===e.type&&(i.p_dns=e.pDns,i.p_tcp=e.pTcp,i.p_ssl=e.pSsl,i.p_ttfb=e.pTtfb,i.p_trans=e.pTrans,i.p_dom=e.pDom,i.p_res=e.pRes,i.p_firstbyte=e.pFirstbyte,i.p_ftp=e.pFpt,i.p_tti=e.pTti,i.p_ready=e.pReady,i.p_load=e.pLoad),t.forEach(function(t){n.indexOf(t)<0&&(i.ext[t]=e[t])}),i.ext=JSON.stringify(i.ext),i}var wt=function(){function t(t){var e=W(t,"logger.body");this.appConfig=t,this.body=new Z(t,e),this.hashChangeTracker=new ot({shouldTrackHashChange:t.onhashchange}),this.urlChangeTracker=new ut({trackReplaceState:!0}),this.pageVisibilityTracker=new lt(t),this.appConfig.onajax&&this.initApi(),this.appConfig.page&&this.initPage(),this.body.getIsSpeedLog()&&this.initPerformance()}var e=t.prototype;return e.initApi=function(){vt(this)},e.initPage=function(){var t;(t=this).appConfig.onhashchange&&t.hashChangeTracker.addTracker(t.send,t),t.urlChangeTracker.addTracker(t.send,t),t.pageVisibilityTracker.addPageloadTracker(t.send,t),t.pageVisibilityTracker.addPageviewTracker(t.send,t),t.pageVisibilityTracker.addPageVisibilityEventTracker(t.send,t),t.pageVisibilityTracker.addPageUnloadTracker(t.send,t)},e.initPerformance=function(){gt(this)},e.get=function(t,e){var n=W(t,"body.url",void 0);return!this.appConfig.ignoreUrl(n)&&nt(yt(this.body.getBody(t.body)),t.url||this.appConfig.logger.url,e)},e.post=function(t,e){var n=W(t,"body.url",void 0);if(this.appConfig.ignoreUrl(n))return!1;var i,r,o,a=yt(this.body.getBody(t.body));return i=a,r=t.url||this.appConfig.logger.url,void 0===(o=e)&&(o=Y),et(i,r,o)},e.send=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=Y),this.appConfig.disabled?(console.error("已经禁用日志功能"),!1):this.body.getIsLog()?this[(t.type||W(this.appConfig,"logger.methods")).toLowerCase()](t,e):(console.error("根据抽样率，已经禁止日志功能"),!1)},t}(),mt=function(){function t(t,e){this.$config=t,this.queue=[],this.setConfig(),this.initQueue(),this.logger=new e(this.config),this.cleanQuene()}var e=t.prototype;return e.setConfig=function(){try{window.mfm.config?this.config=i({},this.$config,window.mfm.config):this.config=this.$config}catch(t){throw new Error("Please use mfm.js by the correct way!")}},e.initQueue=function(){try{window.mfm.queue&&(this.queue=window.mfm.queue.concat(this.queue))}catch(t){throw new Error("Please use mfm.js by the correct way!")}},e.cleanQuene=function(){var e=this;this.queue.forEach(function(t){e.send(t)})},e.send=function(t,e){void 0===t&&(t={}),void 0===e&&(e=Y);var n=(t.type||W(this.config,"logger.methods")).toLowerCase();return this.logger&&this.logger[n]?this.logger[n](t,e):(this.queue.push(t),!1)},t}();window.mfm=new mt({prefix:"_mfm_",disabled:!1,appid:"0000000000",appname:"default",onajax:!1,page:!1,onhashchange:!0,parseTitle:function(t){return{}[t]||""},parseUrl:function(t){return t},ignoreUrl:function(t){return-1<["/log/uploadApiLog"].indexOf(t)},sampleRate:100,siteSpeedSampleRate:100,expires:63072e6,resource:{timeout:200,imgTimeout:300},sentry:{url:"http://1eaacdfcfa024c52b871021d65e71132@staging.sentry.cash.pt.xiaomi.com/9",options:{release:"1.0"}},logger:{url:"http://r.browser.miui.com/log/uploadApiLog",methods:"GET",body:{imei:"",uid:"",did:"",appVersion:"",appName:""}}},wt)}();
//# sourceMappingURL=fmonitor-0.1.2.min.js.map
